tosca_definitions_version: cloudify_dsl_1_3

imports:
  - http://www.getcloudify.org/spec/cloudify/3.4.2/types.yaml
  - http://www.getcloudify.org/spec/fabric-plugin/1.5.3/plugin.yaml
  - helm.yaml


 regional1:
    type: cloudify.nodes.SharedResource
    properties:
      resource_config:
        deployment:
          id: regional1


  regional1-deploy:
    type: cloudify.nodes.Root
    relationships:
      - type: cloudify.relationships.depends_on_shared_resource
        target: regional1
        target_interfaces:
          cloudify.interfaces.relationship_lifecycle:
            establish:
              inputs:
                workflow_id: install_chart_on_clusters
                parameters:
                    package_name: nginx-stable/nginx-ingress
            unlink:
              inputs:
                workflow_id: uninstall_chart_on_clusters
                parameters:
                  package_name: nginx-stable/nginx-ingress